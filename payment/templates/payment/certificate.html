{% load humanize %}
{% load static %}
<html>
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <link rel="stylesheet" type="text/css" href="{% static 'main/css/bootstrap4.min.css' %}" />
    <style type="text/css">
      @font-face {
        font-family: TimesNewRoman;
        src: url(/static/main/fonts/times.ttf);
      }
      body {
        font-family: TimesNewRoman;
        font-size: 14px;
      }
      table {
        font-size: 20px;
      }
      
      @media print {
        @page {
          size: a4; /*auto is the initial value */
          margin: 0mm; /* this affects the margin in the printer settings */
        }
      
        #printPageButton {
          display: none;
        }
      
        body {
          font-size: 14pt;
          margin: 10mm;
        }
      
        body > .container {
          width: 100% !important;
          margin: 0px !important;
          max-width: 100% !important;
        }
      }
      
      table.header-table {
        border-collapse: separate;
        border-spacing: 10px 2px;
      }
      table,
      th,
      td {
        /* border: 1px solid gainsboro;*/
      }
      th {
        font-weight: lighter;
      }
      
      td.border-top2-bottom1,
      th.border-top2-bottom1 {
        border-top: 2px solid black !important;
        border-bottom: 1px solid black;
      }
      
      td.border-top1-bottom2,
      th.border-top1-bottom2 {
        border-top: 1px solid black;
        border-bottom: 2px solid black !important;
      }
      
      .table-bordered td,
      .table-bordered th {
        border: 1px solid rgb(0, 0, 0);
      }
      .table-bordered thead th {
        vertical-align: bottom;
        border-bottom: 2px solid rgb(0, 0, 0);
      }
    </style>
  </head>
  <body>
    <div class="container p-4">
      <div class="row" style="min-height: 350mm; flex-direction: column;">
        <div class="col-12">
          <table class="w-100 header-table">
            <th scope="col" style="width: 40%;">
              {% include 'payment/certificate_header.html' with number=num %}
            </th>
            <th scope="col" colspan="3" class="text-right">В финансовый отдел</th>
            <tr class="align-bottom" style="height: 100;">
              <th scope="col" colspan="4" class="text-center font-weight-bold text-uppercase">Справка</th>
            </tr>
            <tr>
              <th scope="col" colspan="4">на перечисление {{ payment.paymentDest.name }} за {{ payment.createDate|date:'d.m.Y' }} на счета международных дебетовых карт.</th>
            </tr>

            <tr>
              <th scope="col" colspan="4">
                Получатель: {{ bank.printName|default_if_none:bank.name|default_if_none:'' }}<br />
                ИНН/КПП {{ bank.inn|default_if_none:'' }}/{{ bank.kpp|default_if_none:'' }}<br />
                БИК {{ bank.bik|default_if_none:'' }}<br />
                Кор/счет {{ bank.corrAccount|default_if_none:'' }}<br />
                Р/счет {{ bank.currentAccount|default_if_none:'' }}<br />
                Б/счет {{ bank.bAccount|default_if_none:'' }}&nbsp;Д/пр. 0<br />
                <span class="font-weight-bold">на сумму {{ payment.totalSum|floatformat:'0'|intcomma|default_if_none:'' }} руб. {{ payment.totalSum|floatformat:'2'|slice:'-2:'|default_if_none:'' }} коп.</span><br />
                <span class="font-weight-bold">{{ totalSumIntString }} руб. {{ payment.totalSum|floatformat:'2'|slice:'-2:'|default_if_none:'' }} коп.</span>
              </th>
            </tr>

            <tr>
              <th scope="col" colspan="4">
                <span class="font-weight-bold">Назначение платежа:&nbsp;</span>Перевод <span class="font-weight-bold">{{ payment.paymentDest.name }}</span> за {{ payment.createDate|date:'m месяц Y года' }} на счета международных дебетовых карт по реестру <span class="font-weight-bold">{{ registryNumber|default_if_none:'' }} от {{ payment.fileDateTime|date:'d.m.Yг.'|default_if_none:'' }}</span>{% if bank.clientContractNumber is not None %}
                  В соответствии с договором <span class="font-weight-bold">№{{ bank.clientContractNumber }}</span> от <span class="font-weight-bold">{{ bank.clientContractDate|date:'d.m.Y.'|default_if_none:'' }}</span>
                {% endif %}Код вида дохода 2.
              </th>
            </tr>

            {% if prepayments %}
              <tr style="height: 100px;">
                <th scope="col" colspan="4">
                  <table class="table table-bordered table-sm text-center mt-4">
                    <thead>
                      <tr>
                        <th>Сумма платежа</th>
                        <th>Лицевой счет</th>
                        <th>Получатель платежа</th>
                        <th>Код вида дохода</th>
                        <th>ВЗС</th>
                        <th>№ пл. поручения</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for p in prepayments %}
                        <tr>
                          <td class="text-right">{{ p.prepaymentItem.value|intcomma|default_if_none:'' }}</td>
                          <td>{{ p.accountNumber|default_if_none:'' }}</td>
                          <td class="text-left">{{ p.prepaymentItem.prepayment.empFullName|default_if_none:'' }}</td>
                          <td></td>
                          <td></td>
                          <td></td>
                        </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                </th>
              </tr>
            {% endif %}

            <tr style="height: 100px;">
              <th scope="col" colspan="2" class="text-left font-weight-bold">Главный бухгалтер</th>
              <th scope="col"></th>
              <th scope="col" class="text-right font-weight-bold">{{ payment.mainAccountant|default_if_none:'' }}</th>
            </tr>
          </table>
        </div>

        <div class="col-12" style="margin-top: auto; height: 100%;">
          {% include 'payment/certificate_footer.html' %}
        </div>
      </div>
    </div>
  </body>
</html>
